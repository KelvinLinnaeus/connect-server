# Security Guide - Univyn Connect Server

**Version:** 1.0
**Last Updated:** 2025-11-05
**Classification:** Internal Use
**Maintainer:** Security Team

---

## Table of Contents

1. [Overview](#overview)
2. [Security Architecture](#security-architecture)
3. [Authentication & Authorization](#authentication--authorization)
4. [Network Security](#network-security)
5. [Data Protection](#data-protection)
6. [Security Controls](#security-controls)
7. [Operational Security](#operational-security)
8. [Security Testing](#security-testing)
9. [Incident Response](#incident-response)
10. [Compliance & Audit](#compliance--audit)
11. [Developer Security Guide](#developer-security-guide)
12. [Security Checklist](#security-checklist)

---

## Overview

This document describes the security architecture, controls, and operational procedures for the Univyn Connect Server. It serves as the primary reference for:

- **Developers**: Secure coding practices and security controls
- **DevOps**: Secure deployment and operational procedures
- **Security Team**: Security architecture and incident response
- **Auditors**: Security controls and compliance evidence

### Security Objectives

1. **Confidentiality**: Protect user data from unauthorized access
2. **Integrity**: Prevent unauthorized modification of data
3. **Availability**: Ensure service availability and resilience
4. **Accountability**: Maintain audit trails for security-relevant events
5. **Compliance**: Meet regulatory requirements (GDPR, SOC 2, etc.)

### Document Structure

- **doc/THREAT_MODEL.md** - Comprehensive threat analysis
- **doc/SECURITY.md** (this document) - Security controls and operations
- **doc/SECRETS_MANAGEMENT.md** - Secret management procedures
- **doc/INCIDENT_RESPONSE.md** - Incident response playbook

---

## Security Architecture

### Technology Stack

| Component | Technology | Security Features |
|-----------|------------|-------------------|
| **Application** | Go 1.24.0 | Memory safety, type safety, built-in concurrency |
| **Framework** | Gin | Middleware support, request validation |
| **Database** | PostgreSQL 15+ | Row-level security, encryption at rest, prepared statements |
| **Authentication** | PASETO v2 | Symmetric encryption, no algorithm confusion |
| **Password Hashing** | bcrypt | Adaptive hashing, salted |
| **Logging** | zerolog | Structured logging, efficient |

### Security Layers

```
┌─────────────────────────────────────────────────────────────┐
│  Layer 1: Network (HTTPS, TLS 1.2+, HSTS)                  │
├─────────────────────────────────────────────────────────────┤
│  Layer 2: Application Gateway (Rate Limiting, CORS, CSP)    │
├─────────────────────────────────────────────────────────────┤
│  Layer 3: Authentication (PASETO tokens, session mgmt)      │
├─────────────────────────────────────────────────────────────┤
│  Layer 4: Authorization (RBAC, resource ownership)          │
├─────────────────────────────────────────────────────────────┤
│  Layer 5: Input Validation (type checking, sanitization)    │
├─────────────────────────────────────────────────────────────┤
│  Layer 6: Business Logic (service layer validation)         │
├─────────────────────────────────────────────────────────────┤
│  Layer 7: Data Access (SQLC prepared statements, encryption)│
└─────────────────────────────────────────────────────────────┘
```

---

## Authentication & Authorization

### Authentication

#### PASETO Token Authentication

**Why PASETO over JWT?**
- No algorithm confusion vulnerabilities
- Encrypted by default (confidentiality)
- Simpler, more secure design
- Platform-agnostic

**Token Structure:**
```json
{
  "id": "token-uuid",
  "user_id": "user-uuid",
  "username": "johndoe",
  "space_id": "space-uuid",
  "issued_at": "2025-11-05T10:00:00Z",
  "expired_at": "2025-11-05T10:15:00Z"
}
```

**Token Lifecycle:**
- **Access Token**: 15 minutes (short-lived, non-revocable)
- **Refresh Token**: 24 hours (stored in DB, revocable)
- **Rotation**: New access token issued via refresh token
- **Revocation**: Delete session record in database

#### Password Security

**Requirements:**
- Minimum 8 characters
- Mix of uppercase, lowercase, numbers, special characters (enforced by validator)
- No common passwords (can add dictionary check)

**Storage:**
- bcrypt with DefaultCost (currently 10)
- Salt automatically generated by bcrypt
- Never store or log plaintext passwords

**Password Reset:**
1. User requests reset via email
2. Generate secure random token (32+ bytes)
3. Send token via email with expiration (1 hour)
4. Validate token and allow password change
5. Invalidate all existing sessions

#### Account Lockout Protection

**Configuration:**
```go
MaxFailedAttempts = 5          // Before lockout
LockoutDuration = 30 minutes   // Temporary lockout
FailedAttemptWindow = 15 min   // For counting attempts
MaxFailedAttemptsPerIP = 20    // IP-based blocking
```

**Process:**
1. Track failed login attempts per user and IP
2. After 5 failed attempts within 15 minutes: lock account
3. Account auto-unlocks after 30 minutes
4. Admin can manually unlock accounts
5. Successful login resets failed attempt counter

**Monitoring:**
```sql
-- View locked accounts
SELECT id, username, is_locked, locked_until, failed_login_attempts
FROM users
WHERE is_locked = TRUE;

-- Recent login attempts
SELECT username, ip_address, attempt_result, attempted_at
FROM login_attempts
WHERE attempted_at > NOW() - INTERVAL '1 hour'
ORDER BY attempted_at DESC;
```

### Authorization

#### Role-Based Access Control (RBAC)

**Roles:**
- **user**: Standard user (default)
- **moderator**: Can moderate content and users
- **admin**: Full administrative access

**Middleware Functions:**
```go
// Single role required
middleware.RequireRole(store, "admin")

// Multiple roles (OR logic)
middleware.RequireRoles(store, "admin", "moderator")

// Convenience functions
middleware.RequireAdmin(store)
middleware.RequireModerator(store)
middleware.RequireAdminOrModerator(store)

// Resource ownership
middleware.RequireOwnership("user_id")

// Ownership OR privileged role
middleware.RequireOwnershipOrRole(store, "user_id", "admin", "moderator")
```

**Example Usage:**
```go
// Only admins can access
api.GET("/admin/users",
    middleware.AuthMiddleware(tokenMaker),
    middleware.RequireAdmin(store),
    handler.ListUsers)

// Users can only access their own profile, admins can access any
api.GET("/users/:user_id",
    middleware.AuthMiddleware(tokenMaker),
    middleware.RequireOwnershipOrRole(store, "user_id", "admin"),
    handler.GetUser)
```

**Authorization Flow:**
1. `AuthMiddleware`: Verify token, extract user ID
2. `RequireRole`: Fetch user from DB, check roles
3. Authorization failure → 403 Forbidden
4. Authorization success → Continue to handler

**Security Notes:**
- Authorization checks happen on EVERY request
- Roles fetched from database (not from token) - prevents tampering
- All authorization events are logged
- Failed authorization attempts are monitored

---

## Network Security

### HTTPS/TLS

**Configuration:**
- **Production**: HTTPS only, HTTP redirected to HTTPS
- **Development**: HTTP allowed for local testing
- **TLS Version**: 1.2+ only
- **Cipher Suites**: Strong ciphers only (configured at load balancer/reverse proxy)

**HSTS (HTTP Strict Transport Security):**
```
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
```
- Enabled in production only
- Forces browsers to use HTTPS
- Prevents SSL stripping attacks

### CORS (Cross-Origin Resource Sharing)

**Configuration:**
```env
# Development
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Production
CORS_ALLOWED_ORIGINS=https://app.univyn.com,https://admin.univyn.com
```

**Security:**
- ❌ Wildcard (`*`) REJECTED in production
- ✅ Explicit origin whitelist required
- Credentials allowed only for whitelisted origins
- Preflight caching: 12 hours

**Enforcement:**
```go
// Application will FATAL on startup if wildcard used in production
if originsStr == "*" && config.Environment == "production" {
    log.Fatal().Msg("CRITICAL SECURITY ERROR: Wildcard CORS not allowed in production")
}
```

### Security Headers

All responses include comprehensive security headers:

| Header | Value | Purpose |
|--------|-------|---------|
| **Content-Security-Policy** | `default-src 'self'; ...` | Prevent XSS, clickjacking, injection |
| **Strict-Transport-Security** | `max-age=31536000; ...` | Force HTTPS (production only) |
| **X-Content-Type-Options** | `nosniff` | Prevent MIME sniffing |
| **X-Frame-Options** | `DENY` | Prevent clickjacking |
| **X-XSS-Protection** | `1; mode=block` | Legacy XSS protection |
| **Referrer-Policy** | `strict-origin-when-cross-origin` | Control referrer info |
| **Permissions-Policy** | `geolocation=(), ...` | Restrict browser features |
| **Cache-Control** | `no-store, no-cache, ...` | Prevent sensitive data caching |

**Implementation:**
```go
router.Use(middleware.SecurityHeadersMiddleware(config))
```

### Rate Limiting

**Global Rate Limits:**
- **Default**: 100 requests/minute per IP
- **Authentication endpoints**: 5 requests/minute per IP
- **Configurable** via environment variables

**Per-Endpoint Rate Limiting:**
```go
// Apply stricter limits to sensitive endpoints
authRoutes.Use(middleware.RateLimitMiddleware(config.RateLimitAuth))
```

**IP-Based Blocking:**
- 20 failed login attempts from single IP within 15 minutes
- Automatic temporary block for 1 hour
- Logged for security monitoring

### Request Size Limits

**Body Size Limits:**
- **Default**: 1 MB for standard API requests
- **Large**: 10 MB for file upload endpoints
- **Headers**: 8 KB maximum

**Implementation:**
```go
// Global default
router.Use(middleware.DefaultRequestSizeLimitMiddleware())

// Large uploads
uploadRoute.Use(middleware.LargeRequestSizeLimitMiddleware())
```

**Protection Against:**
- Memory exhaustion attacks
- Resource abuse
- Denial of service

---

## Data Protection

### Sensitive Data Classification

| Classification | Examples | Protection |
|----------------|----------|------------|
| **CRITICAL** | Passwords, tokens, API keys | Hashed/encrypted, never logged |
| **HIGH** | PII, emails, phone numbers | Encrypted, PII redacted in logs |
| **MEDIUM** | User content, messages | Encrypted at rest, access controlled |
| **LOW** | Public profiles, posts | Access controlled |

### Encryption

**At Rest:**
- Database: Encryption via PostgreSQL (configure at DB level)
- Backups: Encrypted with strong keys
- Secrets: Stored in secret manager or encrypted .env

**In Transit:**
- HTTPS/TLS 1.2+ for all external communication
- Database connections: SSL/TLS (sslmode=require in production)

### Password Hashing

**Algorithm:** bcrypt with DefaultCost (10)

```go
import "golang.org/x/crypto/bcrypt"

// Hash password
hashedPassword, err := bcrypt.GenerateFromPassword(
    []byte(plainPassword),
    bcrypt.DefaultCost,
)

// Verify password
err := bcrypt.CompareHashAndPassword(hashedPassword, []byte(plainPassword))
```

**Security Properties:**
- Adaptive: Cost can be increased as hardware improves
- Salted: Automatic unique salt per password
- Slow: Designed to be computationally expensive (prevents brute force)

### SQL Injection Prevention

**Primary Defense:** SQLC-generated prepared statements

```sql
-- name: GetUserByEmail :one
SELECT * FROM users WHERE email = $1;
```

Generates:
```go
func (q *Queries) GetUserByEmail(ctx context.Context, email string) (User, error) {
    row := q.db.QueryRowContext(ctx, getUserByEmail, email)
    // ... parameterized query execution
}
```

**Additional Protections:**
- All queries use parameterized queries (no string concatenation)
- Input validation before database queries
- Least-privilege database credentials

### PII Redaction

**Log Redaction:**
Sensitive fields automatically redacted in logs:
- Passwords (never logged)
- Tokens (masked)
- Email addresses (partially masked: u***@example.com)
- Phone numbers (masked)
- Session IDs (masked)

**Implementation:**
```go
// Good: Redacted
log.Info().Str("email_masked", maskEmail(user.Email)).Msg("User logged in")

// Bad: PII exposed
log.Info().Str("email", user.Email).Msg("User logged in")  // ❌ Don't do this
```

---

## Security Controls

### Input Validation

**Framework:** `github.com/go-playground/validator/v10`

**Validation Rules:**
```go
type CreateUserRequest struct {
    Username string `json:"username" binding:"required,min=3,max=50,alphanum"`
    Email    string `json:"email" binding:"required,email"`
    Password string `json:"password" binding:"required,min=8,max=128"`
    FullName string `json:"full_name" binding:"required,min=1,max=100"`
}
```

**Common Patterns:**
- `required`: Field must be present
- `email`: Valid email format
- `min=X,max=Y`: Length constraints
- `alphanum`: Alphanumeric only
- `oneof=a b c`: Enumeration

**Custom Validators:**
```go
// Register custom validator
validate.RegisterValidation("password_strength", validatePasswordStrength)
```

### Output Encoding

**JSON Responses:**
- Gin framework automatically escapes JSON
- HTML special characters encoded

**Error Messages:**
- Sanitized, no stack traces in production
- Standardized format
- No sensitive information disclosure

### Error Handling

**Standardized Error Response:**
```json
{
  "error": "validation_error",
  "message": "Invalid input data",
  "details": {
    "field": "email",
    "issue": "Invalid email format"
  }
}
```

**Security Principles:**
- ❌ Don't expose: Stack traces, internal paths, database errors
- ✅ Do provide: User-friendly messages, validation errors, request IDs

**Implementation:**
```go
// Production: Generic error
c.JSON(http.StatusInternalServerError,
    util.NewErrorResponse("internal_error", "An error occurred"))

// Development: Detailed error
if config.Environment != "production" {
    log.Error().Err(err).Msg("Database error")
}
```

---

## Operational Security

### Secrets Management

**See:** [doc/SECRETS_MANAGEMENT.md](SECRETS_MANAGEMENT.md)

**Quick Reference:**
- ✅ Store in environment variables or secret manager
- ✅ Rotate regularly (every 90 days)
- ✅ Unique per environment (dev/staging/prod)
- ❌ Never commit to Git
- ❌ Never log or expose in errors

**Required Secrets:**
1. `DATABASE_URL` - PostgreSQL connection string
2. `TOKEN_SYMMETRIC_KEY` - PASETO encryption key (≥32 chars)
3. Third-party API keys (if any)

### Audit Logging

**Security Events Logged:**
1. Authentication events (login, logout, failed attempts)
2. Authorization failures (forbidden access attempts)
3. Privilege changes (role assignments)
4. Account lockouts
5. Password changes/resets
6. Administrative actions
7. Suspicious activity

**Log Format:**
```json
{
  "level": "warn",
  "time": "2025-11-05T10:30:00Z",
  "user_id": "uuid",
  "username": "johndoe",
  "ip": "192.168.1.1",
  "endpoint": "/api/admin/users",
  "required_role": "admin",
  "user_roles": ["user"],
  "message": "Authorization failed: user lacks required role"
}
```

**Log Storage:**
- Structured JSON logs (zerolog)
- Centralized logging (configure log shipper: Filebeat, Fluentd, etc.)
- Retention: Minimum 90 days (adjust for compliance)
- Access restricted to authorized personnel

### Monitoring & Alerting

**Security Metrics:**

| Metric | Threshold | Action |
|--------|-----------|--------|
| Failed logins from single IP | >10 in 5 min | Alert, investigate |
| Account lockouts | >5 in 1 hour | Alert, investigate |
| Authorization failures | >50 in 5 min | Alert, check for exploit attempts |
| Rate limit violations | >100 in 1 min | Alert, consider IP blocking |
| Invalid tokens | >20 in 5 min | Alert, possible attack |
| Database connection failures | >5 in 1 min | Critical alert, check DB |

**Implementation:**
- Export metrics to Prometheus/Grafana
- Set up alerting rules
- Create dashboards for security monitoring
- Integrate with incident response system

### Backup & Recovery

**Database Backups:**
- **Frequency**: Daily full backup, hourly incremental (configure at DB level)
- **Retention**: 30 days
- **Encryption**: Backups encrypted at rest
- **Testing**: Monthly restore test
- **Access**: Restricted to authorized personnel

**Recovery Time Objective (RTO):** 4 hours
**Recovery Point Objective (RPO):** 1 hour

---

## Security Testing

### Test Suites

**Location:** `test/security/`

**Test Categories:**

1. **Authentication Tests** (`auth_test.go`)
   - Token verification
   - Password validation
   - Session management
   - Account lockout

2. **Authorization Tests** (`authz_test.go`)
   - Role checking
   - Resource ownership
   - Privilege escalation attempts

3. **Input Validation Tests** (`validation_test.go`)
   - SQL injection attempts
   - XSS payloads
   - Command injection
   - Path traversal

4. **Rate Limiting Tests** (`ratelimit_test.go`)
   - Brute force protection
   - API abuse prevention

5. **Security Headers Tests** (`headers_test.go`)
   - Verify all security headers present
   - Correct header values

**Running Security Tests:**
```bash
# Run all security tests
go test ./test/security/... -v

# Run specific test suite
go test ./test/security/auth_test.go -v

# Run with coverage
go test ./test/security/... -v -cover -coverprofile=coverage.out
go tool cover -html=coverage.out
```

### Automated Security Scanning

**SAST (Static Application Security Testing):**
```bash
# gosec - Go Security Checker
gosec ./...

# Run in CI
gosec -fmt=json -out=gosec-results.json ./...
```

**Dependency Scanning:**
```bash
# Check for known vulnerabilities
go list -json -m all | nancy sleuth

# Or use govulncheck
govulncheck ./...
```

**CI Integration:**
```yaml
# .github/workflows/security.yml
name: Security Checks
on: [push, pull_request]
jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - name: Run gosec
        uses: securego/gosec@master
      - name: Run dependency check
        run: govulncheck ./...
```

### Penetration Testing

**Internal Testing:**

Use `doc/PENETRATION_TEST_CHECKLIST.md` for regular security assessments.

**Key Test Areas:**
1. Authentication bypass attempts
2. Authorization privilege escalation
3. Injection attacks (SQL, XSS, command injection)
4. Session management vulnerabilities
5. API security (rate limiting, input validation)
6. CSRF attacks
7. Information disclosure

**External Testing:**
- Annual penetration test by certified third-party
- Responsible disclosure program for security researchers

---

## Incident Response

**See:** [doc/INCIDENT_RESPONSE.md](INCIDENT_RESPONSE.md)

**Quick Reference:**

**If Credentials Compromised:**
1. Rotate secret immediately
2. Revoke all sessions
3. Notify security team
4. Investigate compromise vector
5. Document incident

**If Suspicious Activity Detected:**
1. Check audit logs for details
2. Identify affected accounts/resources
3. Block malicious IPs if applicable
4. Escalate to security team
5. Monitor for continued attempts

**Contacts:**
- Security Team: security@univyn.com
- On-Call: [Emergency Contact]
- Incident Response Lead: [Contact]

---

## Compliance & Audit

### GDPR Requirements

| Requirement | Implementation |
|-------------|----------------|
| **Right to Access** | API endpoint to export user data |
| **Right to Erasure** | User deletion with cascade |
| **Data Minimization** | Collect only necessary data |
| **Breach Notification** | 72-hour notification process |
| **Privacy by Design** | Security controls built-in |
| **Data Protection** | Encryption, access controls |

### Audit Trail

**Logged Events:**
- User account creation/deletion
- Role changes
- Password changes
- Failed login attempts
- Authorization failures
- Administrative actions
- Data access (sensitive endpoints)

**Log Retention:** 90 days (minimum), adjust for compliance requirements

**Audit Queries:**
```sql
-- Failed login attempts
SELECT * FROM login_attempts
WHERE attempt_result LIKE 'failed%'
  AND attempted_at > NOW() - INTERVAL '24 hours';

-- Account lockouts
SELECT * FROM account_lockouts
WHERE locked_at > NOW() - INTERVAL '7 days';

-- Authorization failures (from application logs)
-- Parse logs for: level=warn, message="Authorization failed"
```

### Compliance Checklist

- [ ] All sensitive data encrypted at rest
- [ ] All data encrypted in transit (HTTPS/TLS)
- [ ] Audit logging enabled and monitored
- [ ] Secrets rotated regularly (every 90 days)
- [ ] Backups encrypted and tested
- [ ] Incident response plan documented and tested
- [ ] Security training completed by all team members
- [ ] Third-party security assessment completed annually
- [ ] Vulnerability scanning automated in CI/CD
- [ ] Access controls enforced (RBAC)

---

## Developer Security Guide

### Secure Coding Checklist

When adding a new endpoint:

1. **Authentication**
   - [ ] Apply `AuthMiddleware` if authentication required
   - [ ] Decide if endpoint should be public or protected

2. **Authorization**
   - [ ] Determine required roles (user/moderator/admin)
   - [ ] Apply appropriate authorization middleware
   - [ ] Consider resource ownership checks

3. **Input Validation**
   - [ ] Define request struct with validation tags
   - [ ] Validate all user inputs
   - [ ] Sanitize inputs if needed

4. **Rate Limiting**
   - [ ] Apply rate limiting to prevent abuse
   - [ ] Use stricter limits for sensitive endpoints

5. **Error Handling**
   - [ ] Return generic errors in production
   - [ ] Don't expose sensitive information
   - [ ] Log detailed errors for debugging

6. **Logging**
   - [ ] Log security-relevant events
   - [ ] Redact PII and sensitive data
   - [ ] Include request context (user ID, IP, endpoint)

### Example: Secure Endpoint

```go
// Good: Comprehensive security
func SetupUserRoutes(api *gin.RouterGroup, handler *UserHandler, store db.Store, tokenMaker auth.Maker) {
    users := api.Group("/users")
    {
        // Public endpoint - no auth required
        users.GET("", handler.ListUsers)

        // Protected endpoint - authentication required
        users.POST("",
            middleware.AuthMiddleware(tokenMaker),
            middleware.RequestSizeLimitMiddleware(DefaultMaxBodySize),
            handler.CreateUser,
        )

        // Owner-only access
        users.GET("/:user_id/profile",
            middleware.AuthMiddleware(tokenMaker),
            middleware.RequireOwnership("user_id"),
            handler.GetUserProfile,
        )

        // Admin-only access
        users.DELETE("/:user_id",
            middleware.AuthMiddleware(tokenMaker),
            middleware.RequireAdmin(store),
            handler.DeleteUser,
        )
    }
}
```

### Common Security Mistakes

**❌ Don't:**
```go
// Hardcoded credentials
db, _ := sql.Open("postgres", "user:password@localhost/db")

// SQL injection vulnerability
query := fmt.Sprintf("SELECT * FROM users WHERE email = '%s'", email)

// Exposing sensitive data in logs
log.Info().Str("password", password).Msg("User login")

// Missing authorization check
func DeleteUser(c *gin.Context) {
    userID := c.Param("user_id")
    // Directly delete without checking if requester has permission
    store.DeleteUser(ctx, userID)
}

// Returning detailed error to client
c.JSON(500, gin.H{"error": err.Error()}) // Exposes internal details
```

**✅ Do:**
```go
// Use environment variables
databaseURL := os.Getenv("DATABASE_URL")

// Use parameterized queries (SQLC)
user, err := store.GetUserByEmail(ctx, email)

// Redact sensitive data
log.Info().Str("email_masked", maskEmail(email)).Msg("User login")

// Apply authorization middleware
api.DELETE("/users/:user_id",
    middleware.AuthMiddleware(tokenMaker),
    middleware.RequireAdmin(store),
    handler.DeleteUser,
)

// Return generic error
c.JSON(500, util.NewErrorResponse("internal_error", "An error occurred"))
```

---

## Security Checklist

### Development

- [ ] `.env` and `app.env` in `.gitignore`
- [ ] No hardcoded credentials in code
- [ ] All user inputs validated
- [ ] SQL queries use SQLC (prepared statements)
- [ ] Passwords hashed with bcrypt
- [ ] Sensitive data redacted in logs
- [ ] Error messages sanitized
- [ ] Authorization checks on all protected endpoints
- [ ] Rate limiting applied to sensitive endpoints
- [ ] Security tests written and passing

### Deployment

- [ ] `ENVIRONMENT=production` set
- [ ] `DATABASE_URL` uses SSL/TLS (`sslmode=require`)
- [ ] `TOKEN_SYMMETRIC_KEY` is ≥32 random characters
- [ ] `CORS_ALLOWED_ORIGINS` set to specific domains (not `*`)
- [ ] HTTPS enabled and enforced
- [ ] Security headers configured
- [ ] Secrets stored in secret manager
- [ ] Database backups enabled and encrypted
- [ ] Monitoring and alerting configured
- [ ] Audit logging enabled

### Operations

- [ ] Secrets rotated regularly (every 90 days)
- [ ] Dependency updates applied monthly
- [ ] Security scan results reviewed
- [ ] Audit logs reviewed regularly
- [ ] Incident response plan tested
- [ ] Security training current for team
- [ ] Backup restores tested monthly
- [ ] Failed login attempts monitored
- [ ] Account lockouts reviewed

### Compliance

- [ ] GDPR compliance documented
- [ ] Data retention policies implemented
- [ ] Privacy policy updated
- [ ] Breach notification procedure documented
- [ ] Third-party security assessment completed
- [ ] Vendor security reviewed
- [ ] Data processing agreements signed

---

## Additional Resources

### Documentation

- [OWASP Top 10](https://owasp.org/Top10/)
- [OWASP API Security Top 10](https://owasp.org/API-Security/)
- [Go Security Best Practices](https://go.dev/doc/security/)
- [PostgreSQL Security](https://www.postgresql.org/docs/current/security.html)

### Tools

- **gosec**: Go security checker
- **govulncheck**: Go vulnerability scanner
- **sqlc**: Type-safe SQL code generator
- **truffleHog**: Secret scanner
- **OWASP ZAP**: Web application security scanner

### Internal Documents

- [doc/THREAT_MODEL.md](THREAT_MODEL.md) - Threat analysis
- [doc/SECRETS_MANAGEMENT.md](SECRETS_MANAGEMENT.md) - Secret management
- [doc/INCIDENT_RESPONSE.md](INCIDENT_RESPONSE.md) - Incident procedures
- [doc/PENETRATION_TEST_CHECKLIST.md](PENETRATION_TEST_CHECKLIST.md) - Testing guide

---

## Document Control

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2025-11-05 | Security Team | Initial comprehensive security guide |

**Next Review Date:** 2026-02-05 (Quarterly)

**For questions or to report security issues:**
- Email: security@univyn.com
- Responsible Disclosure: security@univyn.com (PGP key available)

---

**Classification:** Internal Use
**Distribution:** Engineering, DevOps, Security, Audit Teams
